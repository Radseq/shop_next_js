import { PageFooter } from "@/components/footer/PageFooter";
import { Navigation } from "@/components/header/Navigation";
import { TopBar } from "@/components/header/TopBar";
import { News } from "@/components/homePage/News";
import { GetStaticProps } from "next";
import Head from "next/head";
import styles from "../styles/MainPageBody.module.css";
import { RootNavigation } from "@/components/header/Types";
import { ImageToSlide } from "@/components/homePage/Types";
import { SeparateSection } from "@/components/homePage/SeparateSection";
import { RecommendedProducts } from "@/components/homePage/recommendedProducts/RecommendedProducts";
import { RecommendedProduct } from "@/components/homePage/recommendedProducts/Types";
import { HotSellProduct } from "@/components/homePage/hotSellPanel/Types";
import { Promotions } from "@/components/homePage/promotions/Promotions";
import { Promotion } from "@/components/homePage/promotions/Types";
import { HitsOfTheWeek } from "@/components/homePage/hitsOfTheWeekSlider/HitsOfTheWeek";
import { HitOfWeekProduct } from "@/components/homePage/hitsOfTheWeekSlider/Types";
import { BestSellers } from "@/components/homePage/bestsellers/BestSellers";
import { BestsellerProduct } from "@/components/homePage/bestsellers/Types";

export default function Home(props: {
	navigationData: RootNavigation[];
	advertisementData: ImageToSlide[];
	recommendedProductsData: RecommendedProduct[];
	hotSellProductData: HotSellProduct;
	promotions: Promotion[];
	hitsOfTheWeekProducts: HitOfWeekProduct[];
	bestsellers: BestsellerProduct[];
}) {
	return (
		<div>
			<Head>
				<title>Create Next App</title>
				<meta
					name="description"
					content="Generated by create next app"
				/>
				<meta
					name="viewport"
					content="width=device-width, initial-scale=1"
				/>
				<link rel="icon" href="/favicon.ico" />
			</Head>
			<main>
				<div className={styles.webMain}>
					<header>
						<TopBar />
						<Navigation navigations={props.navigationData} />
					</header>
					<main>
						<div className={styles.mainPageBody}>
							<News advertising={props.advertisementData} />
							<SeparateSection sectionName="Recomended products" />
							<RecommendedProducts
								recommendedProduct={
									props.recommendedProductsData
								}
							/>
							<hr />
							<SeparateSection
								sectionName="Promotions"
								url="/promotions"
							/>
							<Promotions promotionsData={props.promotions} />
							<hr />
							<SeparateSection
								sectionName="Hits of the week"
								url="/hitsoftheweek"
							/>
							<HitsOfTheWeek
								hitsOfTheWeek={props.hitsOfTheWeekProducts}
							/>
							<hr />
							<SeparateSection
								sectionName="Bestsellers"
								url="/bestsellers"
							/>
							<BestSellers products={props.bestsellers} />
							<hr />
						</div>
					</main>
					<footer>
						<PageFooter />
					</footer>
				</div>
			</main>
		</div>
	);
}

export const getStaticProps: GetStaticProps = async ({ params }) => {
	const navigationsResult = await fetch(
		"http://localhost:3000/api/navigation/navigation/"
	);
	const navigations = await navigationsResult.json();

	const advertisingResult = await fetch(
		"http://localhost:3000/api/advertising/advertisement/"
	);
	const advertisement = await advertisingResult.json();

	const recommendedProductsResult = await fetch(
		"http://localhost:3000/api/recommendedProduct/recommendedProduct/"
	);
	const recommendedProducts = await recommendedProductsResult.json();

	const promotionsResult = await fetch(
		"http://localhost:3000/api/promotion/promotion/"
	);
	const promotions = await promotionsResult.json();

	const hitsOfTheWeekResult = await fetch(
		"http://localhost:3000/api/hitsOfTheWeek/hitsOfTheWeek/"
	);
	const hitsOfTheWeekProducts = await hitsOfTheWeekResult.json();

	const bestsellerResult = await fetch(
		"http://localhost:3000/api/bestsellerProduct/bestsellerProduct/"
	);
	const bestsellers = await bestsellerResult.json();

	return {
		props: {
			navigationData: navigations,
			advertisementData: advertisement,
			recommendedProductsData: recommendedProducts,
			promotions,
			hitsOfTheWeekProducts,
			bestsellers,
		},
	};
};
